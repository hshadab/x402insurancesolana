<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>API Documentation - x402 Insurance | Verifiable Refund Claims</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --bg-primary: #0B0E1C;
            --bg-secondary: #1A1F3A;
            --accent-primary: #C77DFF;
            --accent-secondary: #E0E0E0;
            --accent-warning: #FFB800;
            --accent-danger: #FF4757;
            --text-primary: #FFFFFF;
            --text-secondary: #B8BCC8;
            --panel-bg: rgba(26, 31, 58, 0.95);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            overflow-x: hidden;
            position: relative;
            min-height: 100vh;
            color: var(--text-primary);
        }

        /* Animated background particles */
        .bg-animation { position: fixed; width: 100%; height: 100%; overflow: hidden; z-index: 0; }
        .particle { position: absolute; width: 4px; height: 4px; background: rgba(199, 125, 255, 0.3); border-radius: 50%; animation: float 20s infinite linear; }

        @keyframes float {
            from { transform: translateY(100vh) translateX(0); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            to { transform: translateY(-100vh) translateX(100px); opacity: 0; }
        }

        @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.5} }

        /* Header */
        .header {
            position: fixed; top: 0; left: 0; right: 0;
            background: var(--panel-bg); backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(199, 125, 255, 0.2);
            padding: 15px 30px; z-index: 1000;
            display: flex; justify-content: space-between; align-items: center;
        }

        .logo {
            display: flex; align-items: center; gap: 10px;
            cursor: pointer;
            text-decoration: none;
        }

        .logo img {
            height: 32px;
            width: auto;
        }

        .nav-buttons { display: flex; gap: 10px; align-items: center; }
        .nav-btn {
            padding: 8px 16px;
            background: rgba(199, 125, 255, 0.1);
            border: 1px solid rgba(199, 125, 255, 0.3);
            border-radius: 8px;
            color: var(--accent-primary);
            cursor: pointer; transition: all 0.3s ease; font-size: 13px;
            border: none;
        }
        .nav-btn:hover { background: rgba(199, 125, 255, 0.2); transform: translateY(-2px); box-shadow: 0 5px 15px rgba(199, 125, 255, 0.3); }

        /* Main content */
        .main-content {
            position: relative;
            z-index: 1;
            padding: 100px 30px 50px;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Documentation header */
        .docs-header {
            text-align: center;
            margin-bottom: 60px;
        }

        .docs-title {
            font-size: 48px;
            font-weight: 900;
            background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
        }

        .docs-subtitle {
            font-size: 20px;
            color: var(--text-secondary);
            font-weight: 300;
        }

        /* Section */
        .section {
            background: var(--panel-bg);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(199, 125, 255, 0.2);
            border-radius: 16px;
            padding: 40px;
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 32px;
            color: var(--accent-primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .section-content {
            color: var(--text-secondary);
            line-height: 1.8;
            font-size: 16px;
        }

        .section-content p {
            margin-bottom: 15px;
        }

        .section-content ul, .section-content ol {
            margin-left: 25px;
            margin-bottom: 15px;
        }

        .section-content li {
            margin-bottom: 10px;
        }

        /* Endpoint card */
        .endpoint {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(199, 125, 255, 0.2);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .endpoint-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .http-method {
            padding: 6px 12px;
            border-radius: 6px;
            font-weight: bold;
            font-size: 12px;
            font-family: 'Courier New', monospace;
        }

        .http-get { background: rgba(0, 212, 255, 0.2); color: var(--accent-secondary); }
        .http-post { background: rgba(199, 125, 255, 0.2); color: var(--accent-primary); }

        .endpoint-path {
            font-family: 'Courier New', monospace;
            font-size: 16px;
            color: var(--text-primary);
            font-weight: bold;
        }

        .endpoint-description {
            color: var(--text-secondary);
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .endpoint-section-title {
            font-size: 14px;
            color: var(--accent-primary);
            font-weight: bold;
            margin-bottom: 10px;
            margin-top: 20px;
        }

        /* Code block */
        .code-block {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(199, 125, 255, 0.2);
            border-radius: 8px;
            padding: 20px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            color: var(--accent-secondary);
            overflow-x: auto;
            white-space: pre;
            position: relative;
        }

        .code-block .comment {
            color: var(--text-secondary);
            font-style: italic;
        }

        .code-block .key {
            color: var(--accent-primary);
        }

        .code-block .string {
            color: #FFB800;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 5px 10px;
            background: rgba(199, 125, 255, 0.1);
            border: 1px solid rgba(199, 125, 255, 0.3);
            border-radius: 4px;
            color: var(--accent-primary);
            cursor: pointer;
            font-size: 11px;
            transition: all 0.2s;
        }

        .copy-btn:hover {
            background: rgba(199, 125, 255, 0.2);
        }

        /* Table */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(199, 125, 255, 0.1);
        }

        th {
            color: var(--accent-primary);
            font-weight: bold;
            font-size: 14px;
        }

        td {
            color: var(--text-secondary);
            font-size: 14px;
        }

        td code {
            background: rgba(199, 125, 255, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: var(--accent-secondary);
            font-size: 12px;
        }

        /* Badge */
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
            margin-left: 10px;
        }

        .badge.required {
            background: rgba(255, 71, 87, 0.2);
            color: var(--accent-danger);
        }

        .badge.optional {
            background: rgba(255, 184, 0, 0.2);
            color: var(--accent-warning);
        }

        .badge.public {
            background: rgba(199, 125, 255, 0.2);
            color: var(--accent-primary);
        }

        /* Info box */
        .info-box {
            background: rgba(0, 212, 255, 0.1);
            border-left: 3px solid var(--accent-secondary);
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .info-box.warning {
            background: rgba(255, 184, 0, 0.1);
            border-left-color: var(--accent-warning);
        }

        .info-box strong {
            color: var(--accent-secondary);
        }

        .info-box.warning strong {
            color: var(--accent-warning);
        }

        /* Quick nav */
        .quick-nav {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(199, 125, 255, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 40px;
        }

        .quick-nav h3 {
            color: var(--accent-primary);
            margin-bottom: 15px;
            font-size: 18px;
        }

        .quick-nav ul {
            list-style: none;
            margin: 0;
        }

        .quick-nav li {
            margin-bottom: 10px;
        }

        .quick-nav a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: all 0.2s;
            display: block;
            padding: 8px 12px;
            border-radius: 6px;
        }

        .quick-nav a:hover {
            color: var(--accent-primary);
            background: rgba(199, 125, 255, 0.1);
            transform: translateX(5px);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .main-content { padding: 90px 20px 30px; }
            .section { padding: 25px; }
            .docs-title { font-size: 36px; }
            .docs-subtitle { font-size: 16px; }
            .section-title { font-size: 24px; }
            .endpoint { padding: 20px; }
            .nav-buttons { gap: 5px; }
            .nav-btn { padding: 6px 12px; font-size: 12px; }
        }
    </style>
</head>
<body>
    <!-- Background animation -->
    <div class="bg-animation" id="bgAnimation"></div>

    <!-- Header -->
    <div class="header">
        <a href="/" class="logo">
            <img src="https://cdn.prod.website-files.com/65d52b07d5bc41614daa723f/665df12739c532f45b665fe7_logo-novanet.svg" alt="NovaNet Logo">
        </a>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="window.location.href='/'">Home</button>
            <button class="nav-btn" onclick="window.location.href='/docs'">API Docs</button>
            <button class="nav-btn" onclick="window.open('https://github.com/hshadab/x402insurance', '_blank')">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" style="vertical-align: middle; margin-right: 5px;">
                    <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                </svg>
                GitHub
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Header -->
        <div class="docs-header">
            <h1 class="docs-title">API Documentation</h1>
            <p class="docs-subtitle">Complete reference for AI agents - Verifiable Refund Claims for AI Agents</p>
        </div>

        <!-- Quick Navigation -->
        <div class="quick-nav">
            <h3>üìë Quick Navigation</h3>
            <ul>
                <li><a href="#overview">Overview</a></li>
                <li><a href="#authentication">Authentication</a></li>
                <li><a href="#endpoints">Endpoints</a></li>
                <li><a href="#workflow">Integration Workflow</a></li>
                <li><a href="#examples">Code Examples</a></li>
                <li><a href="#errors">Error Handling</a></li>
            </ul>
        </div>

        <!-- Overview -->
        <div class="section" id="overview">
            <h2 class="section-title">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M12 16v-4"/>
                    <path d="M12 8h.01"/>
                </svg>
                Overview
            </h2>
            <div class="section-content">
                <p>
                    <strong>x402 Insurance</strong> provides zero-knowledge proof verified insurance against micropayment fraud. AI agents can purchase insurance policies that protect against merchant fraud during x402 payment protocol interactions.
                </p>

                <div class="info-box">
                    <strong>ü§ñ Built for AI Agents:</strong> This service is designed for autonomous AI agents using the A2A (Agent-to-Agent) protocol. While humans can view this documentation, all API interactions should be performed by agents.
                </div>

                <p><strong>Key Features:</strong></p>
                <ul>
                    <li><strong>Zero-Knowledge Proofs:</strong> Claims are verified using NovaNet without revealing private merchant data</li>
                    <li><strong>Instant Payouts:</strong> Valid claims trigger automatic USDC refunds on Base Mainnet</li>
                    <li><strong>Publicly Verifiable:</strong> Anyone can independently verify claim proofs via public endpoint</li>
                    <li><strong>x402 Compliant:</strong> Integrated with the x402 micropayment protocol</li>
                </ul>

                <p><strong>Base URL:</strong></p>
                <div class="code-block">https://your-instance.onrender.com</div>

                <p><strong>Network:</strong> Base Mainnet (Chain ID: 8453)</p>
                <p><strong>Payment Token:</strong> USDC (0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913)</p>
            </div>
        </div>

        <!-- Authentication -->
        <div class="section" id="authentication">
            <h2 class="section-title">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                    <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                </svg>
                Authentication
            </h2>
            <div class="section-content">
                <p>
                    x402 Insurance uses the <strong>x402 payment protocol</strong> for authentication. Agents must include payment proofs in the <code>x-payment-proof</code> header when accessing protected endpoints.
                </p>

                <p><strong>Protected Endpoints:</strong></p>
                <ul>
                    <li><code>POST /insure</code> - Requires x402 payment (1% of coverage amount in USDC)</li>
                </ul>

                <p><strong>Public Endpoints:</strong></p>
                <ul>
                    <li><code>POST /claim</code> - Submit fraud claims (no payment required)</li>
                    <li><code>POST /verify</code> - Verify zero-knowledge proofs</li>
                    <li><code>GET /proofs/:id</code> - Download proof data</li>
                </ul>

                <div class="info-box warning">
                    <strong>‚ö†Ô∏è Payment Required:</strong> Premium payments are verified on-chain. Ensure your agent has sufficient USDC balance and gas fees (ETH) on Base Mainnet before purchasing policies.
                </div>
            </div>
        </div>

        <!-- Endpoints -->
        <div class="section" id="endpoints">
            <h2 class="section-title">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
                </svg>
                API Endpoints
            </h2>
            <div class="section-content">

                <!-- Agent Discovery -->
                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="http-method http-get">GET</span>
                        <span class="endpoint-path">/.well-known/agent-card.json</span>
                        <span class="badge public">PUBLIC</span>
                    </div>
                    <p class="endpoint-description">
                        Agent-to-Agent (A2A) discovery endpoint. Returns service metadata for agent discovery protocols.
                    </p>

                    <div class="endpoint-section-title">Response Example:</div>
                    <div class="code-block">{
  "name": "x402 Insurance API",
  "description": "Zero-knowledge proof verified insurance",
  "category": "insurance",
  "x402Version": 1,
  "endpoints": {
    "insure": "/insure",
    "claim": "/claim"
  }
}</div>
                </div>

                <!-- Create Policy -->
                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="http-method http-post">POST</span>
                        <span class="endpoint-path">/insure</span>
                        <span class="badge required">x402 PAYMENT REQUIRED</span>
                    </div>
                    <p class="endpoint-description">
                        Purchase an insurance policy. Agents pay a premium (1% of coverage amount) via x402 protocol to insure against merchant fraud for 24 hours.
                    </p>

                    <div class="endpoint-section-title">Headers:</div>
                    <table>
                        <tr>
                            <th>Header</th>
                            <th>Value</th>
                            <th>Required</th>
                        </tr>
                        <tr>
                            <td><code>Content-Type</code></td>
                            <td>application/json</td>
                            <td>Yes</td>
                        </tr>
                        <tr>
                            <td><code>x-payment-proof</code></td>
                            <td>x402 payment proof JSON</td>
                            <td>Yes</td>
                        </tr>
                    </table>

                    <div class="endpoint-section-title">Request Body:</div>
                    <div class="code-block">{
  "merchant_url": "https://api.example.com",
  "coverage_amount": 0.01  <span class="comment">// USDC amount (max 0.1)</span>
}</div>

                    <div class="endpoint-section-title">Response (200 OK):</div>
                    <div class="code-block">{
  "policy_id": "550e8400-e29b-41d4-a716-446655440000",
  "agent_address": "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb",
  "merchant_url_hash": "0xabc123...",
  "coverage_amount": 0.01,
  "premium": 0.0001,  <span class="comment">// 1% of coverage</span>
  "expires_at": "2025-11-07T12:00:00Z",
  "status": "active"
}</div>

                    <div class="info-box">
                        <strong>üí∞ Premium Calculation:</strong> Premium = coverage_amount √ó 1%. For $0.01 USDC coverage, premium is $0.0001 USDC (0.0001 USDC = 100 units).
                    </div>
                </div>

                <!-- Submit Claim -->
                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="http-method http-post">POST</span>
                        <span class="endpoint-path">/claim</span>
                        <span class="badge public">PUBLIC</span>
                    </div>
                    <p class="endpoint-description">
                        Submit a fraud claim with HTTP response evidence. The zkEngine will generate a zero-knowledge proof and automatically issue a refund if fraud is detected.
                    </p>

                    <div class="endpoint-section-title">Request Body:</div>
                    <div class="code-block">{
  "policy_id": "550e8400-e29b-41d4-a716-446655440000",
  "http_response": {
    "status": 503,
    "body": "",
    "headers": {
      "content-type": "application/json"
    }
  }
}</div>

                    <div class="endpoint-section-title">Response (200 OK):</div>
                    <div class="code-block">{
  "claim_id": "claim-abc123",
  "proof": "0xdef456...",  <span class="comment">// ZK proof hash</span>
  "public_inputs": [1, 503, 0, 10000],  <span class="comment">// [is_fraud, status, body_len, payout]</span>
  "proof_generation_time_ms": 15234,
  "verification_result": true,
  "payout_amount": 0.01,
  "refund_tx_hash": "0x789abc...",  <span class="comment">// Base Mainnet tx</span>
  "status": "paid"
}</div>

                    <div class="endpoint-section-title">Fraud Detection Criteria:</div>
                    <table>
                        <tr>
                            <th>Condition</th>
                            <th>Fraud?</th>
                        </tr>
                        <tr>
                            <td>HTTP status ‚â• 500 (server error)</td>
                            <td>‚úÖ Yes</td>
                        </tr>
                        <tr>
                            <td>HTTP body length = 0 (empty response)</td>
                            <td>‚úÖ Yes</td>
                        </tr>
                        <tr>
                            <td>HTTP status ‚â• 400 AND body empty</td>
                            <td>‚úÖ Yes</td>
                        </tr>
                        <tr>
                            <td>HTTP status 2xx/3xx with valid body</td>
                            <td>‚ùå No</td>
                        </tr>
                    </table>

                    <div class="info-box warning">
                        <strong>‚è±Ô∏è Proof Generation Time:</strong> zkEngine takes 10-20 seconds to generate proofs. Total claim processing time is 15-30 seconds including blockchain confirmation.
                    </div>
                </div>

                <!-- Verify Proof -->
                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="http-method http-post">POST</span>
                        <span class="endpoint-path">/verify</span>
                        <span class="badge public">PUBLIC</span>
                    </div>
                    <p class="endpoint-description">
                        Verify a zero-knowledge proof independently. Anyone can verify that a claim was proven correctly without access to private merchant data.
                    </p>

                    <div class="endpoint-section-title">Request Body:</div>
                    <div class="code-block">{
  "proof": "0xdef456...",
  "public_inputs": [1, 503, 0, 10000]
}</div>

                    <div class="endpoint-section-title">Response (200 OK):</div>
                    <div class="code-block">{
  "valid": true,
  "fraud_detected": true,  <span class="comment">// public_inputs[0] == 1</span>
  "payout_amount": 10000   <span class="comment">// public_inputs[3]</span>
}</div>

                    <div class="endpoint-section-title">Public Inputs Format:</div>
                    <table>
                        <tr>
                            <th>Index</th>
                            <th>Field</th>
                            <th>Description</th>
                        </tr>
                        <tr>
                            <td>0</td>
                            <td><code>is_fraud</code></td>
                            <td>1 if fraud detected, 0 otherwise</td>
                        </tr>
                        <tr>
                            <td>1</td>
                            <td><code>http_status</code></td>
                            <td>HTTP status code from merchant</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td><code>body_length</code></td>
                            <td>Response body length in bytes</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td><code>payout_amount</code></td>
                            <td>Payout in USDC units (1e6 = $1)</td>
                        </tr>
                    </table>
                </div>

                <!-- Get Proof -->
                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="http-method http-get">GET</span>
                        <span class="endpoint-path">/proofs/:claim_id</span>
                        <span class="badge public">PUBLIC</span>
                    </div>
                    <p class="endpoint-description">
                        Download complete proof data for auditing. All claim records are publicly accessible for transparency.
                    </p>

                    <div class="endpoint-section-title">Response (200 OK):</div>
                    <div class="code-block">{
  "claim_id": "claim-abc123",
  "policy_id": "550e8400-e29b-41d4-a716-446655440000",
  "proof": "0xdef456...",
  "public_inputs": [1, 503, 0, 10000],
  "proof_generation_time_ms": 15234,
  "verification_result": true,
  "http_status": 503,
  "http_body_hash": "0xe3b0c44...",
  "payout_amount": 0.01,
  "refund_tx_hash": "0x789abc...",
  "recipient_address": "0x742d35Cc...",
  "status": "paid",
  "created_at": "2025-11-06T12:00:00Z",
  "paid_at": "2025-11-06T12:00:25Z"
}</div>
                </div>

                <!-- Dashboard Data -->
                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="http-method http-get">GET</span>
                        <span class="endpoint-path">/api/dashboard</span>
                        <span class="badge public">PUBLIC</span>
                    </div>
                    <p class="endpoint-description">
                        Get live statistics and recent activity for monitoring and analytics.
                    </p>

                    <div class="endpoint-section-title">Response (200 OK):</div>
                    <div class="code-block">{
  "stats": {
    "total_policies": 42,
    "total_coverage": 0.42,
    "claims_paid": 0.05,
    "active_policies": 12
  },
  "recent_policies": [...],
  "recent_claims": [...],
  "blockchain": {
    "chain_id": 8453,
    "block_number": 12345678,
    "wallet_address": "0xba72eD...",
    "eth_balance": "0.05",
    "usdc_balance": "100.00"
  }
}</div>
                </div>

            </div>
        </div>

        <!-- Workflow -->
        <div class="section" id="workflow">
            <h2 class="section-title">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                    <polyline points="22 4 12 14.01 9 11.01"/>
                </svg>
                Integration Workflow
            </h2>
            <div class="section-content">
                <p><strong>Typical agent workflow for using x402 Insurance:</strong></p>

                <ol>
                    <li>
                        <strong>Discover Service</strong>
                        <div class="code-block">GET /.well-known/agent-card.json</div>
                        <p>Agent discovers x402 Insurance via A2A protocol.</p>
                    </li>

                    <li>
                        <strong>Purchase Insurance Policy</strong>
                        <div class="code-block">POST /insure
Headers: x-payment-proof (x402 payment)
Body: { merchant_url, coverage_amount }</div>
                        <p>Agent pays premium (1% of coverage) and receives policy_id.</p>
                    </li>

                    <li>
                        <strong>Make Protected API Call</strong>
                        <div class="code-block"><span class="comment"># Agent calls merchant API with x402 payment</span>
POST https://merchant.com/api/service
Headers: x-payment-proof
Body: { ... }</div>
                        <p>Agent makes API call to merchant with insurance protection.</p>
                    </li>

                    <li>
                        <strong>If Fraud Occurs, Submit Claim</strong>
                        <div class="code-block">POST /claim
Body: {
  policy_id: "...",
  http_response: { status: 503, body: "", headers: {} }
}</div>
                        <p>If merchant returns error, agent submits claim with response evidence.</p>
                    </li>

                    <li>
                        <strong>Receive Automatic Refund</strong>
                        <div class="code-block"><span class="comment"># zkEngine generates proof (10-20 sec)</span>
<span class="comment"># If proof validates fraud, USDC refund issued automatically</span>
Response: {
  refund_tx_hash: "0x789...",
  payout_amount: 0.01
}</div>
                        <p>zkEngine proves fraud in zero-knowledge, triggers instant USDC refund on Base.</p>
                    </li>
                </ol>

                <div class="info-box">
                    <strong>üîê Privacy Preserved:</strong> Zero-knowledge proofs ensure merchant API response details remain private while publicly proving fraud was correctly detected.
                </div>
            </div>
        </div>

        <!-- Examples -->
        <div class="section" id="examples">
            <h2 class="section-title">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="16 18 22 12 16 6"/>
                    <polyline points="8 6 2 12 8 18"/>
                </svg>
                Code Examples
            </h2>
            <div class="section-content">

                <h3 style="color: var(--accent-primary); margin-top: 30px; margin-bottom: 15px;">Python Example</h3>
                <div class="code-block">import requests
from x402 import create_payment_proof

<span class="comment"># 1. Purchase insurance policy</span>
coverage_amount = 0.01  <span class="comment"># $0.01 USDC</span>
premium = coverage_amount * 0.01  <span class="comment"># 1% = $0.0001 USDC</span>

payment_proof = create_payment_proof(
    amount=premium,
    recipient="0xba72eD392dB9d67813D68D562D2d67c36fFF566b",
    network="base"
)

response = requests.post(
    "https://insurance.x402.com/insure",
    headers={"x-payment-proof": payment_proof},
    json={
        "merchant_url": "https://api.merchant.com",
        "coverage_amount": coverage_amount
    }
)

policy = response.json()
print(f"Policy created: {policy['policy_id']}")

<span class="comment"># 2. Call merchant API (protected by insurance)</span>
merchant_response = requests.post(
    "https://api.merchant.com/service",
    headers={"x-payment-proof": merchant_payment_proof},
    json={"query": "example"}
)

<span class="comment"># 3. If fraud occurs, submit claim</span>
if merchant_response.status_code >= 500:
    claim_response = requests.post(
        "https://insurance.x402.com/claim",
        json={
            "policy_id": policy["policy_id"],
            "http_response": {
                "status": merchant_response.status_code,
                "body": merchant_response.text,
                "headers": dict(merchant_response.headers)
            }
        }
    )

    claim = claim_response.json()
    print(f"Claim submitted: {claim['claim_id']}")
    print(f"Refund tx: {claim['refund_tx_hash']}")
    print(f"Payout: ${claim['payout_amount']} USDC")</div>

                <h3 style="color: var(--accent-primary); margin-top: 30px; margin-bottom: 15px;">JavaScript/TypeScript Example</h3>
                <div class="code-block">import { createPaymentProof } from '@x402/client';

<span class="comment">// 1. Purchase insurance policy</span>
const coverageAmount = 0.01; <span class="comment">// $0.01 USDC</span>
const premium = coverageAmount * 0.01; <span class="comment">// 1%</span>

const paymentProof = await createPaymentProof({
  amount: premium,
  recipient: '0xba72eD392dB9d67813D68D562D2d67c36fFF566b',
  network: 'base'
});

const policyResponse = await fetch('https://insurance.x402.com/insure', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'x-payment-proof': paymentProof
  },
  body: JSON.stringify({
    merchant_url: 'https://api.merchant.com',
    coverage_amount: coverageAmount
  })
});

const policy = await policyResponse.json();
console.log(`Policy created: ${policy.policy_id}`);

<span class="comment">// 2. Call merchant API (protected)</span>
const merchantResponse = await fetch('https://api.merchant.com/service', {
  method: 'POST',
  headers: {
    'x-payment-proof': merchantPaymentProof
  },
  body: JSON.stringify({ query: 'example' })
});

<span class="comment">// 3. Submit claim if fraud detected</span>
if (merchantResponse.status >= 500) {
  const claimResponse = await fetch('https://insurance.x402.com/claim', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      policy_id: policy.policy_id,
      http_response: {
        status: merchantResponse.status,
        body: await merchantResponse.text(),
        headers: Object.fromEntries(merchantResponse.headers)
      }
    })
  });

  const claim = await claimResponse.json();
  console.log(`Refund issued: ${claim.refund_tx_hash}`);
}</div>

            </div>
        </div>

        <!-- Error Handling -->
        <div class="section" id="errors">
            <h2 class="section-title">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="12" y1="8" x2="12" y2="12"/>
                    <line x1="12" y1="16" x2="12.01" y2="16"/>
                </svg>
                Error Handling
            </h2>
            <div class="section-content">
                <p><strong>Standard HTTP status codes:</strong></p>

                <table>
                    <tr>
                        <th>Code</th>
                        <th>Status</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><code>200</code></td>
                        <td>OK</td>
                        <td>Request successful</td>
                    </tr>
                    <tr>
                        <td><code>400</code></td>
                        <td>Bad Request</td>
                        <td>Invalid request body or parameters</td>
                    </tr>
                    <tr>
                        <td><code>402</code></td>
                        <td>Payment Required</td>
                        <td>x402 payment missing or invalid</td>
                    </tr>
                    <tr>
                        <td><code>404</code></td>
                        <td>Not Found</td>
                        <td>Policy or claim not found</td>
                    </tr>
                    <tr>
                        <td><code>500</code></td>
                        <td>Internal Server Error</td>
                        <td>Server error (zkEngine failure, blockchain issues)</td>
                    </tr>
                </table>

                <div class="endpoint-section-title">Error Response Format:</div>
                <div class="code-block">{
  "error": "Policy not found",
  "code": "POLICY_NOT_FOUND",
  "details": "No active policy with ID 550e8400..."
}</div>

                <div class="endpoint-section-title">Common Errors:</div>
                <table>
                    <tr>
                        <th>Error Code</th>
                        <th>Cause</th>
                        <th>Solution</th>
                    </tr>
                    <tr>
                        <td><code>PAYMENT_REQUIRED</code></td>
                        <td>Missing x402 payment proof</td>
                        <td>Include valid payment in x-payment-proof header</td>
                    </tr>
                    <tr>
                        <td><code>INSUFFICIENT_PAYMENT</code></td>
                        <td>Payment amount too low</td>
                        <td>Pay exact premium (1% of coverage amount)</td>
                    </tr>
                    <tr>
                        <td><code>POLICY_NOT_FOUND</code></td>
                        <td>Invalid policy_id</td>
                        <td>Use valid policy_id from /insure response</td>
                    </tr>
                    <tr>
                        <td><code>POLICY_EXPIRED</code></td>
                        <td>Policy exceeded 24 hours</td>
                        <td>Purchase new policy</td>
                    </tr>
                    <tr>
                        <td><code>PROOF_GENERATION_FAILED</code></td>
                        <td>zkEngine error</td>
                        <td>Retry claim submission</td>
                    </tr>
                    <tr>
                        <td><code>BLOCKCHAIN_ERROR</code></td>
                        <td>Base network issues</td>
                        <td>Wait and retry, check Basescan</td>
                    </tr>
                </table>

                <div class="info-box warning">
                    <strong>‚ö†Ô∏è Retry Logic:</strong> Implement exponential backoff for transient errors (500, BLOCKCHAIN_ERROR). zkEngine proof generation may take 10-20 seconds - do not timeout prematurely.
                </div>
            </div>
        </div>

        <!-- Rate Limits & Best Practices -->
        <div class="section">
            <h2 class="section-title">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2v20M2 12h20"/>
                </svg>
                Rate Limits & Best Practices
            </h2>
            <div class="section-content">
                <p><strong>Rate Limits:</strong></p>
                <ul>
                    <li>No hard rate limits currently enforced</li>
                    <li>Proof generation is rate-limited by zkEngine (1 concurrent proof per instance)</li>
                    <li>Blockchain transactions limited by Base network capacity</li>
                </ul>

                <p><strong>Best Practices:</strong></p>
                <ul>
                    <li>‚úÖ Only purchase insurance for high-risk merchant interactions</li>
                    <li>‚úÖ Cache policy_id for reuse within 24-hour window</li>
                    <li>‚úÖ Implement retry logic with exponential backoff</li>
                    <li>‚úÖ Verify proofs independently using <code>POST /verify</code></li>
                    <li>‚úÖ Monitor refund transactions on Basescan</li>
                    <li>‚ùå Don't spam claims - only submit for genuine fraud</li>
                    <li>‚ùå Don't purchase policies with coverage > $0.1 USDC (current limit)</li>
                </ul>

                <div class="info-box">
                    <strong>üí° Cost Optimization:</strong> Since premium is 1% of coverage, insure only the exact payment amount to minimize costs. For a $0.01 API call, use $0.01 coverage (not more).
                </div>
            </div>
        </div>

        <!-- Support -->
        <div class="section">
            <h2 class="section-title">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                    <line x1="12" y1="17" x2="12.01" y2="17"/>
                </svg>
                Support & Resources
            </h2>
            <div class="section-content">
                <p><strong>Need Help?</strong></p>
                <ul>
                    <li>üìñ <a href="https://github.com/hshadab/x402insurance" target="_blank" style="color: var(--accent-primary);">GitHub Repository</a> - Source code and issues</li>
                    <li>üåê <a href="https://basescan.org/address/0xba72eD392dB9d67813D68D562D2d67c36fFF566b" target="_blank" style="color: var(--accent-primary);">Basescan</a> - Verify on-chain transactions</li>
                    <li>üîó <a href="https://docs.x402.org" target="_blank" style="color: var(--accent-primary);">x402 Protocol Docs</a> - Learn about x402 payments</li>
                    <li>üß™ <a href="https://docs.arecibo.dev" target="_blank" style="color: var(--accent-primary);">Arecibo/Nova Docs</a> - Zero-knowledge proof system</li>
                </ul>

                <p><strong>Contract Addresses (Base Mainnet):</strong></p>
                <div class="code-block">Insurance Backend: 0xba72eD392dB9d67813D68D562D2d67c36fFF566b
USDC Token:        0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913
Network:           Base (Chain ID 8453)
RPC:               https://mainnet.base.org</div>
            </div>
        </div>

    </div>

    <script>
        // Background particles
        function createParticles() {
            const bgAnimation = document.getElementById('bgAnimation');
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                bgAnimation.appendChild(particle);
            }
        }

        // Initialize
        createParticles();

        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });
    </script>
</body>
</html>
